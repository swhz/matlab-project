A=1085;
B=0.207;
c=0.136;
CN=0.678;
e=-6;%时差
d=(20.6*pi)/180;%(太阳赤纬）
l=114+20/60;%当地经度
ls=120;%标准时对应经度
f=(30+37/60)*pi/180;%当地纬度（转化成弧度）
w=(ts+(l-ls)/15+e/60-12)*15;%太阳时角
w=(w*pi)/180;%将度转化为弧度
h=asin(sin(d)*sin(f)+cos(d)*cos(f)*cos(w));%计算太阳高度角
a=asin(sin(w)*cos(d)/cos(h));%计算太阳方位角
r=abs(a-b);%计算墙面方位角,b表示墙面方位角
i=acos(sin(h)*cos(p)+cos(h)*sin(p)*cos(r));%计算表面太阳光线入射角，p表示墙面倾角
Fg=0.5*(1-cos(p));
Fs=1-Fg;
Idn=A*CN*exp(-B/sin(h));%计算太阳直射辐射强度
Idnm=Idn*cos(i);%计算表面太阳直射辐射强度
Ids=c*Idn;%计算天空散射辐射强度
Idsm=Ids*Fs;%计算表面天空散射辐射强度
Idg=pg*Idn*(c+sin(h));%计算地面散射辐射
Idgm=Idg*Fg;%计算表面地面散射辐射强度
Ia=Idnm+Idsm+Idgm;%表面总辐射强度
GDc=GD*cos(i);%计算表面直射辐射，GD表示地面接收的直射辐射
Fg=0.5*(1-cos(p));%计算角系数
Gdc=Gd*Fg;%计算表面散射辐射，Gd表示地面接收的散射辐射
Gr=(GD+Gd)*pg*Fg;%计算表面接收的地面反射辐射，pg表示地面反射率
Gtc=GDc+Gdc+Gr;%计算表面太阳总辐射